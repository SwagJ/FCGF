Sender: LSF System <lsfadmin@lo-g2-020>
Subject: Job 5697077: <./scripts/train_fcgf_threedmatch.sh bash> in cluster <leonhard> Done

Job <./scripts/train_fcgf_threedmatch.sh bash> was submitted from host <lo-login-01> by user <majing> in cluster <leonhard> at Mon Apr  6 19:54:56 2020
Job was executed on host(s) <4*lo-g2-020>, in queue <gpu.4h>, as user <majing> in cluster <leonhard> at Mon Apr  6 19:55:10 2020
</cluster/home/majing> was used as the home directory.
</cluster/scratch/majing/FCGF> was used as the working directory.
Started at Mon Apr  6 19:55:10 2020
Terminated at Mon Apr  6 19:56:25 2020
Results reported at Mon Apr  6 19:56:25 2020

Your job looked like:

------------------------------------------------------------
# LSBATCH: User input
./scripts/train_fcgf_threedmatch.sh bash
------------------------------------------------------------

Successfully completed.

Resource usage summary:

    CPU time :                                   48.29 sec.
    Max Memory :                                 2723 MB
    Average Memory :                             1241.50 MB
    Total Requested Memory :                     18000.00 MB
    Delta Memory :                               15277.00 MB
    Max Swap :                                   -
    Max Processes :                              6
    Max Threads :                                8
    Run time :                                   93 sec.
    Turnaround time :                            89 sec.

The output (if any) follows:

./outputs/ThreeDMatchPairDataset-v0.05/JointLossTrainer/JointNet/modelnout32
Host:  lo-g2-020
which: no conda in (/cluster/apps/lsf/10.1/linux3.10-glibc2.17-x86_64/bin:/cluster/apps/local:/cluster/apps/sfos/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/cluster/home/majing/.local/bin:/cluster/home/majing/bin)
Conda 
/cluster/scratch/majing/FCGF
Version:  32ee6f4c59d77299814b43947460ed65f87dae09
Git diff

diff --git a/MinkowskiEngine b/MinkowskiEngine
index a0a8ce3..9d8dfae 160000
--- a/MinkowskiEngine
+++ b/MinkowskiEngine
@@ -1 +1 @@
-Subproject commit a0a8ce3ac6aab1e3107a057ff9ec3394087ade6c
+Subproject commit 9d8dfae09968f4a154b96ea38adee7ab02a74563
diff --git a/model/resunet.py b/model/resunet.py
index 251935e..7e9ab9f 100644
--- a/model/resunet.py
+++ b/model/resunet.py
@@ -283,7 +283,7 @@ class Detection(nn.Module):
 
     coords_A = (coords.view(coords.shape[0], 1, 3).repeat(1, coords.shape[0], 1)).short()
     coords_B = (coords.view(1, coords.shape[0], 3).repeat(coords.shape[0], 1, 1)).short()
-    coords_confusion = (torch.stack((coords_A, coords_B), dim=2)).short
+    coords_confusion = (torch.stack((coords_A, coords_B), dim=2)).short()
     every_dist = (((coords_confusion[:, :, 0, :] - coords_confusion[:, :, 1, :]) ** 2).sum(dim=2) ** 0.5).float16()
 
 
diff --git a/scripts/train_fcgf_threedmatch.sh b/scripts/train_fcgf_threedmatch.sh
index 2d93c5b..9b69bd4 100755
--- a/scripts/train_fcgf_threedmatch.sh
+++ b/scripts/train_fcgf_threedmatch.sh
@@ -1,4 +1,5 @@
 #! /bin/bash
+
 export PATH_POSTFIX=$1
 export MISC_ARGS=$2
 
@@ -70,7 +71,7 @@ python train.py \
 	--out_dir ${OUT_DIR} \
 	--use_random_scale ${RANDOM_SCALE} \
 	--positive_pair_search_voxel_size_multiplier ${POSITIVE_PAIR_SEARCH_VOXEL_SIZE_MULTIPLIER} \
-	--kitti_root ${KITTI_PATH} \
+	--threed_match_dir ${THREED_PATH} \
 	--hit_ratio_thresh 0.3 \
 	#--icp_cache_path "/disk/kitti/icp" \
 	#--resume ${OUT_DIR} \

Mon Apr  6 19:55:31 2020       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.39       Driver Version: 418.39       CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  GeForce RTX 208...  Off  | 00000000:3D:00.0 Off |                  N/A |
|  0%   34C    P8     3W / 250W |      0MiB / 10989MiB |      0%   E. Process |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|  No running processes found                                                 |
+-----------------------------------------------------------------------------+

The following have been reloaded with a version change:
  1) gcc/4.8.5 => gcc/6.3.0

Requirement already up-to-date: torch in /cluster/home/majing/.local/lib/python3.7/site-packages (1.4.0)
Requirement already up-to-date: torchvision in /cluster/home/majing/.local/lib/python3.7/site-packages (0.5.0)
Requirement already satisfied, skipping upgrade: six in /cluster/apps/python/3.7.4_gpu_gcc630/x86_64/lib64/python3.7/site-packages (from torchvision) (1.12.0)
Requirement already satisfied, skipping upgrade: pillow>=4.1.1 in /cluster/apps/python/3.7.4_gpu_gcc630/x86_64/lib64/python3.7/site-packages (from torchvision) (6.2.0)
Requirement already satisfied, skipping upgrade: numpy in /cluster/home/majing/.local/lib/python3.7/site-packages (from torchvision) (1.18.2)
Requirement already up-to-date: numpy in /cluster/home/majing/.local/lib/python3.7/site-packages (1.18.2)

Using built objects

Using BLAS=openblas
rm -f -rf build dist
running install
running bdist_egg
running egg_info
writing MinkowskiEngine.egg-info/PKG-INFO
writing dependency_links to MinkowskiEngine.egg-info/dependency_links.txt
writing requirements to MinkowskiEngine.egg-info/requires.txt
writing top-level names to MinkowskiEngine.egg-info/top_level.txt
reading manifest file 'MinkowskiEngine.egg-info/SOURCES.txt'
reading manifest template 'MANIFEST.in'
writing manifest file 'MinkowskiEngine.egg-info/SOURCES.txt'
installing library code to build/bdist.linux-x86_64/egg
running install_lib
running build_py
creating build
creating build/lib.linux-x86_64-3.7
creating build/lib.linux-x86_64-3.7/MinkowskiEngine
copying ./MinkowskiEngine/SparseTensor.py -> build/lib.linux-x86_64-3.7/MinkowskiEngine
copying ./MinkowskiEngine/MinkowskiChannelwiseConvolution.py -> build/lib.linux-x86_64-3.7/MinkowskiEngine
copying ./MinkowskiEngine/MinkowskiPruning.py -> build/lib.linux-x86_64-3.7/MinkowskiEngine
copying ./MinkowskiEngine/MinkowskiCoords.py -> build/lib.linux-x86_64-3.7/MinkowskiEngine
copying ./MinkowskiEngine/MinkowskiNetwork.py -> build/lib.linux-x86_64-3.7/MinkowskiEngine
copying ./MinkowskiEngine/MinkowskiUnion.py -> build/lib.linux-x86_64-3.7/MinkowskiEngine
copying ./MinkowskiEngine/MinkowskiNormalization.py -> build/lib.linux-x86_64-3.7/MinkowskiEngine
copying ./MinkowskiEngine/MinkowskiNonlinearity.py -> build/lib.linux-x86_64-3.7/MinkowskiEngine
copying ./MinkowskiEngine/MinkowskiBroadcast.py -> build/lib.linux-x86_64-3.7/MinkowskiEngine
copying ./MinkowskiEngine/MinkowskiFunctional.py -> build/lib.linux-x86_64-3.7/MinkowskiEngine
copying ./MinkowskiEngine/MinkowskiConvolution.py -> build/lib.linux-x86_64-3.7/MinkowskiEngine
copying ./MinkowskiEngine/Common.py -> build/lib.linux-x86_64-3.7/MinkowskiEngine
copying ./MinkowskiEngine/__init__.py -> build/lib.linux-x86_64-3.7/MinkowskiEngine
copying ./MinkowskiEngine/MinkowskiPooling.py -> build/lib.linux-x86_64-3.7/MinkowskiEngine
copying ./MinkowskiEngine/MinkowskiOps.py -> build/lib.linux-x86_64-3.7/MinkowskiEngine
creating build/lib.linux-x86_64-3.7/MinkowskiEngine/utils
copying ./MinkowskiEngine/utils/coords.py -> build/lib.linux-x86_64-3.7/MinkowskiEngine/utils
copying ./MinkowskiEngine/utils/collation.py -> build/lib.linux-x86_64-3.7/MinkowskiEngine/utils
copying ./MinkowskiEngine/utils/quantization.py -> build/lib.linux-x86_64-3.7/MinkowskiEngine/utils
copying ./MinkowskiEngine/utils/gradcheck.py -> build/lib.linux-x86_64-3.7/MinkowskiEngine/utils
copying ./MinkowskiEngine/utils/init.py -> build/lib.linux-x86_64-3.7/MinkowskiEngine/utils
copying ./MinkowskiEngine/utils/__init__.py -> build/lib.linux-x86_64-3.7/MinkowskiEngine/utils
creating build/lib.linux-x86_64-3.7/MinkowskiEngine/modules
copying ./MinkowskiEngine/modules/senet_block.py -> build/lib.linux-x86_64-3.7/MinkowskiEngine/modules
copying ./MinkowskiEngine/modules/resnet_block.py -> build/lib.linux-x86_64-3.7/MinkowskiEngine/modules
copying ./MinkowskiEngine/modules/__init__.py -> build/lib.linux-x86_64-3.7/MinkowskiEngine/modules
running build_ext
building 'MinkowskiEngineBackend' extension
creating build/temp.linux-x86_64-3.7
creating build/temp.linux-x86_64-3.7/pybind
/cluster/spack/apps/linux-centos7-x86_64/gcc-4.8.5/gcc-6.3.0-d7fey5ouwb3cw26w5zqafqcse7q3fs6d/bin/gcc -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -ftree-vectorize -march=core-avx2 -mavx2 -ftree-vectorize -march=core-avx2 -mavx2 -fPIC -I./ -I/cluster/apps/python/3.7.4_gpu_gcc630/x86_64/include/python3.7m/.. -I/cluster/home/majing/.local/lib/python3.7/site-packages/torch/include -I/cluster/home/majing/.local/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -I/cluster/home/majing/.local/lib/python3.7/site-packages/torch/include/TH -I/cluster/home/majing/.local/lib/python3.7/site-packages/torch/include/THC -I/cluster/apps/gcc-6.3.0/cuda-10.1.243-n6qg6z5js3zfnhp2cfg5yjccej636czm/include -I/cluster/apps/python/3.7.4_gpu_gcc630/x86_64/include/python3.7m -c pybind/minkowski.cpp -o build/temp.linux-x86_64-3.7/pybind/minkowski.o -Wno-deprecated-declarations -DTORCH_API_INCLUDE_EXTENSION_H -DTORCH_EXTENSION_NAME=MinkowskiEngineBackend -D_GLIBCXX_USE_CXX11_ABI=0 -std=c++11
/cluster/spack/apps/linux-centos7-x86_64/gcc-4.8.5/gcc-6.3.0-d7fey5ouwb3cw26w5zqafqcse7q3fs6d/bin/g++ -pthread -shared build/temp.linux-x86_64-3.7/pybind/minkowski.o -Lobjs -L/cluster/apps/gcc-6.3.0/cuda-10.1.243-n6qg6z5js3zfnhp2cfg5yjccej636czm/lib64 -L/cluster/apps/python/3.7.4_gpu_gcc630/x86_64/lib64 -lminkowski -lcusparse -lopenblas -lcudart -lpython3.7m -o build/lib.linux-x86_64-3.7/MinkowskiEngineBackend.cpython-37m-x86_64-linux-gnu.so -Wl,-rpath,/cluster/apps/gcc-6.3.0/openblas-0.2.19-jusdys62qhv52qjbsoewvthriekuaynw/lib
creating build/bdist.linux-x86_64
creating build/bdist.linux-x86_64/egg
copying build/lib.linux-x86_64-3.7/MinkowskiEngineBackend.cpython-37m-x86_64-linux-gnu.so -> build/bdist.linux-x86_64/egg
creating build/bdist.linux-x86_64/egg/MinkowskiEngine
copying build/lib.linux-x86_64-3.7/MinkowskiEngine/SparseTensor.py -> build/bdist.linux-x86_64/egg/MinkowskiEngine
creating build/bdist.linux-x86_64/egg/MinkowskiEngine/modules
copying build/lib.linux-x86_64-3.7/MinkowskiEngine/modules/senet_block.py -> build/bdist.linux-x86_64/egg/MinkowskiEngine/modules
copying build/lib.linux-x86_64-3.7/MinkowskiEngine/modules/resnet_block.py -> build/bdist.linux-x86_64/egg/MinkowskiEngine/modules
copying build/lib.linux-x86_64-3.7/MinkowskiEngine/modules/__init__.py -> build/bdist.linux-x86_64/egg/MinkowskiEngine/modules
creating build/bdist.linux-x86_64/egg/MinkowskiEngine/utils
copying build/lib.linux-x86_64-3.7/MinkowskiEngine/utils/coords.py -> build/bdist.linux-x86_64/egg/MinkowskiEngine/utils
copying build/lib.linux-x86_64-3.7/MinkowskiEngine/utils/collation.py -> build/bdist.linux-x86_64/egg/MinkowskiEngine/utils
copying build/lib.linux-x86_64-3.7/MinkowskiEngine/utils/quantization.py -> build/bdist.linux-x86_64/egg/MinkowskiEngine/utils
copying build/lib.linux-x86_64-3.7/MinkowskiEngine/utils/gradcheck.py -> build/bdist.linux-x86_64/egg/MinkowskiEngine/utils
copying build/lib.linux-x86_64-3.7/MinkowskiEngine/utils/init.py -> build/bdist.linux-x86_64/egg/MinkowskiEngine/utils
copying build/lib.linux-x86_64-3.7/MinkowskiEngine/utils/__init__.py -> build/bdist.linux-x86_64/egg/MinkowskiEngine/utils
copying build/lib.linux-x86_64-3.7/MinkowskiEngine/MinkowskiChannelwiseConvolution.py -> build/bdist.linux-x86_64/egg/MinkowskiEngine
copying build/lib.linux-x86_64-3.7/MinkowskiEngine/MinkowskiPruning.py -> build/bdist.linux-x86_64/egg/MinkowskiEngine
copying build/lib.linux-x86_64-3.7/MinkowskiEngine/MinkowskiCoords.py -> build/bdist.linux-x86_64/egg/MinkowskiEngine
copying build/lib.linux-x86_64-3.7/MinkowskiEngine/MinkowskiNetwork.py -> build/bdist.linux-x86_64/egg/MinkowskiEngine
copying build/lib.linux-x86_64-3.7/MinkowskiEngine/MinkowskiUnion.py -> build/bdist.linux-x86_64/egg/MinkowskiEngine
copying build/lib.linux-x86_64-3.7/MinkowskiEngine/MinkowskiNormalization.py -> build/bdist.linux-x86_64/egg/MinkowskiEngine
copying build/lib.linux-x86_64-3.7/MinkowskiEngine/MinkowskiNonlinearity.py -> build/bdist.linux-x86_64/egg/MinkowskiEngine
copying build/lib.linux-x86_64-3.7/MinkowskiEngine/MinkowskiBroadcast.py -> build/bdist.linux-x86_64/egg/MinkowskiEngine
copying build/lib.linux-x86_64-3.7/MinkowskiEngine/MinkowskiFunctional.py -> build/bdist.linux-x86_64/egg/MinkowskiEngine
copying build/lib.linux-x86_64-3.7/MinkowskiEngine/MinkowskiConvolution.py -> build/bdist.linux-x86_64/egg/MinkowskiEngine
copying build/lib.linux-x86_64-3.7/MinkowskiEngine/Common.py -> build/bdist.linux-x86_64/egg/MinkowskiEngine
copying build/lib.linux-x86_64-3.7/MinkowskiEngine/__init__.py -> build/bdist.linux-x86_64/egg/MinkowskiEngine
copying build/lib.linux-x86_64-3.7/MinkowskiEngine/MinkowskiPooling.py -> build/bdist.linux-x86_64/egg/MinkowskiEngine
copying build/lib.linux-x86_64-3.7/MinkowskiEngine/MinkowskiOps.py -> build/bdist.linux-x86_64/egg/MinkowskiEngine
byte-compiling build/bdist.linux-x86_64/egg/MinkowskiEngine/SparseTensor.py to SparseTensor.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MinkowskiEngine/modules/senet_block.py to senet_block.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MinkowskiEngine/modules/resnet_block.py to resnet_block.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MinkowskiEngine/modules/__init__.py to __init__.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MinkowskiEngine/utils/coords.py to coords.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MinkowskiEngine/utils/collation.py to collation.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MinkowskiEngine/utils/quantization.py to quantization.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MinkowskiEngine/utils/gradcheck.py to gradcheck.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MinkowskiEngine/utils/init.py to init.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MinkowskiEngine/utils/__init__.py to __init__.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MinkowskiEngine/MinkowskiChannelwiseConvolution.py to MinkowskiChannelwiseConvolution.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MinkowskiEngine/MinkowskiPruning.py to MinkowskiPruning.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MinkowskiEngine/MinkowskiCoords.py to MinkowskiCoords.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MinkowskiEngine/MinkowskiNetwork.py to MinkowskiNetwork.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MinkowskiEngine/MinkowskiUnion.py to MinkowskiUnion.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MinkowskiEngine/MinkowskiNormalization.py to MinkowskiNormalization.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MinkowskiEngine/MinkowskiNonlinearity.py to MinkowskiNonlinearity.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MinkowskiEngine/MinkowskiBroadcast.py to MinkowskiBroadcast.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MinkowskiEngine/MinkowskiFunctional.py to MinkowskiFunctional.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MinkowskiEngine/MinkowskiConvolution.py to MinkowskiConvolution.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MinkowskiEngine/Common.py to Common.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MinkowskiEngine/__init__.py to __init__.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MinkowskiEngine/MinkowskiPooling.py to MinkowskiPooling.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MinkowskiEngine/MinkowskiOps.py to MinkowskiOps.cpython-37.pyc
creating stub loader for MinkowskiEngineBackend.cpython-37m-x86_64-linux-gnu.so
byte-compiling build/bdist.linux-x86_64/egg/MinkowskiEngineBackend.py to MinkowskiEngineBackend.cpython-37.pyc
creating build/bdist.linux-x86_64/egg/EGG-INFO
copying MinkowskiEngine.egg-info/PKG-INFO -> build/bdist.linux-x86_64/egg/EGG-INFO
copying MinkowskiEngine.egg-info/SOURCES.txt -> build/bdist.linux-x86_64/egg/EGG-INFO
copying MinkowskiEngine.egg-info/dependency_links.txt -> build/bdist.linux-x86_64/egg/EGG-INFO
copying MinkowskiEngine.egg-info/not-zip-safe -> build/bdist.linux-x86_64/egg/EGG-INFO
copying MinkowskiEngine.egg-info/requires.txt -> build/bdist.linux-x86_64/egg/EGG-INFO
copying MinkowskiEngine.egg-info/top_level.txt -> build/bdist.linux-x86_64/egg/EGG-INFO
writing build/bdist.linux-x86_64/egg/EGG-INFO/native_libs.txt
creating dist
creating 'dist/MinkowskiEngine-0.4.2-py3.7-linux-x86_64.egg' and adding 'build/bdist.linux-x86_64/egg' to it
removing 'build/bdist.linux-x86_64/egg' (and everything under it)
Processing MinkowskiEngine-0.4.2-py3.7-linux-x86_64.egg
removing '/cluster/home/majing/.local/lib/python3.7/site-packages/MinkowskiEngine-0.4.2-py3.7-linux-x86_64.egg' (and everything under it)
creating /cluster/home/majing/.local/lib/python3.7/site-packages/MinkowskiEngine-0.4.2-py3.7-linux-x86_64.egg
Extracting MinkowskiEngine-0.4.2-py3.7-linux-x86_64.egg to /cluster/home/majing/.local/lib/python3.7/site-packages
MinkowskiEngine 0.4.2 is already the active version in easy-install.pth

Installed /cluster/home/majing/.local/lib/python3.7/site-packages/MinkowskiEngine-0.4.2-py3.7-linux-x86_64.egg
Processing dependencies for MinkowskiEngine==0.4.2
Searching for numpy==1.18.2
Best match: numpy 1.18.2
Adding numpy 1.18.2 to easy-install.pth file
Installing f2py script to /cluster/home/majing/.local/bin
Installing f2py3 script to /cluster/home/majing/.local/bin
Installing f2py3.7 script to /cluster/home/majing/.local/bin

Using /cluster/home/majing/.local/lib/python3.7/site-packages
Searching for torch==1.4.0
Best match: torch 1.4.0
Adding torch 1.4.0 to easy-install.pth file
Installing convert-caffe2-to-onnx script to /cluster/home/majing/.local/bin
Installing convert-onnx-to-caffe2 script to /cluster/home/majing/.local/bin

Using /cluster/home/majing/.local/lib/python3.7/site-packages
Finished processing dependencies for MinkowskiEngine==0.4.2
04/06 19:56:19 ===> Configurations
04/06 19:56:19     out_dir: ./outputs/ThreeDMatchPairDataset-v0.05/JointLossTrainer/JointNet/modelnout32
04/06 19:56:19     trainer: JointLossTrainer
04/06 19:56:19     save_freq_epoch: 1
04/06 19:56:19     batch_size: 8
04/06 19:56:19     val_batch_size: 1
04/06 19:56:19     use_hard_negative: True
04/06 19:56:19     hard_negative_sample_ratio: 0.05
04/06 19:56:19     hard_negative_max_num: 3000
04/06 19:56:19     num_pos_per_batch: 1024
04/06 19:56:19     num_hn_samples_per_batch: 256
04/06 19:56:19     neg_thresh: 1.4
04/06 19:56:19     pos_thresh: 0.1
04/06 19:56:19     neg_weight: 1
04/06 19:56:19     use_random_scale: True
04/06 19:56:19     min_scale: 0.8
04/06 19:56:19     max_scale: 1.2
04/06 19:56:19     use_random_rotation: True
04/06 19:56:19     rotation_range: 360
04/06 19:56:19     train_phase: train
04/06 19:56:19     val_phase: val
04/06 19:56:19     test_phase: test
04/06 19:56:19     stat_freq: 40
04/06 19:56:19     test_valid: True
04/06 19:56:19     val_max_iter: 400
04/06 19:56:19     val_epoch_freq: 1
04/06 19:56:19     positive_pair_search_voxel_size_multiplier: 1.5
04/06 19:56:19     hit_ratio_thresh: 0.3
04/06 19:56:19     triplet_num_pos: 256
04/06 19:56:19     triplet_num_hn: 512
04/06 19:56:19     triplet_num_rand: 1024
04/06 19:56:19     model: JointNet
04/06 19:56:19     backbone_model: ResUNetBN2C
04/06 19:56:19     model_n_out: 32
04/06 19:56:19     conv1_kernel_size: 5
04/06 19:56:19     normalize_feature: True
04/06 19:56:19     dist_type: L2
04/06 19:56:19     best_val_metric: feat_match_ratio
04/06 19:56:19     optimizer: SGD
04/06 19:56:19     max_epoch: 200
04/06 19:56:19     lr: 0.1
04/06 19:56:19     momentum: 0.8
04/06 19:56:19     sgd_momentum: 0.9
04/06 19:56:19     sgd_dampening: 0.1
04/06 19:56:19     adam_beta1: 0.9
04/06 19:56:19     adam_beta2: 0.999
04/06 19:56:19     weight_decay: 0.0001
04/06 19:56:19     iter_size: 1
04/06 19:56:19     bn_momentum: 0.05
04/06 19:56:19     exp_gamma: 0.99
04/06 19:56:19     scheduler: ExpLR
04/06 19:56:19     icp_cache_path: /disk/kitti/
04/06 19:56:19     use_gpu: True
04/06 19:56:19     weights: None
04/06 19:56:19     weights_dir: None
04/06 19:56:19     resume: None
04/06 19:56:19     resume_dir: None
04/06 19:56:19     train_num_thread: 2
04/06 19:56:19     val_num_thread: 1
04/06 19:56:19     test_num_thread: 2
04/06 19:56:19     fast_validation: False
04/06 19:56:19     nn_max_n: 500
04/06 19:56:19     dataset: ThreeDMatchPairDataset
04/06 19:56:19     voxel_size: 0.05
04/06 19:56:19     threed_match_dir: /cluster/scratch/majing/threedmatch/
04/06 19:56:19     kitti_root: /disk/kitti/
04/06 19:56:19     kaist_root: /disk_ssd/kaist/
04/06 19:56:19     kitti_max_time_diff: 3
04/06 19:56:19     kaist_max_time_diff: 3
04/06 19:56:19     kitti_date: 2011_09_26
04/06 19:56:19     kaist_date: 2020_03_10
04/06 19:56:19 Loading the subset train from /cluster/scratch/majing/threedmatch/
04/06 19:56:19 Loading the subset val from /cluster/scratch/majing/threedmatch/
04/06 19:56:23 JointNet(
  (feature_extraction0): ResUNetBN2C(
    (conv1): MinkowskiConvolution(in=1, out=32, region_type=RegionType.HYPERCUBE, kernel_size=[5, 5, 5], stride=[1, 1, 1], dilation=[1, 1, 1])
    (norm1): MinkowskiBatchNorm(32, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
    (block1): BasicBlockBN(
      (conv1): MinkowskiConvolution(in=32, out=32, region_type=RegionType.HYPERCUBE, kernel_size=[3, 3, 3], stride=[1, 1, 1], dilation=[1, 1, 1])
      (norm1): MinkowskiBatchNorm(32, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
      (conv2): MinkowskiConvolution(in=32, out=32, region_type=RegionType.HYPERCUBE, kernel_size=[3, 3, 3], stride=[1, 1, 1], dilation=[1, 1, 1])
      (norm2): MinkowskiBatchNorm(32, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
    )
    (conv2): MinkowskiConvolution(in=32, out=64, region_type=RegionType.HYPERCUBE, kernel_size=[3, 3, 3], stride=[2, 2, 2], dilation=[1, 1, 1])
    (norm2): MinkowskiBatchNorm(64, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
    (block2): BasicBlockBN(
      (conv1): MinkowskiConvolution(in=64, out=64, region_type=RegionType.HYPERCUBE, kernel_size=[3, 3, 3], stride=[1, 1, 1], dilation=[1, 1, 1])
      (norm1): MinkowskiBatchNorm(64, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
      (conv2): MinkowskiConvolution(in=64, out=64, region_type=RegionType.HYPERCUBE, kernel_size=[3, 3, 3], stride=[1, 1, 1], dilation=[1, 1, 1])
      (norm2): MinkowskiBatchNorm(64, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
    )
    (conv3): MinkowskiConvolution(in=64, out=128, region_type=RegionType.HYPERCUBE, kernel_size=[3, 3, 3], stride=[2, 2, 2], dilation=[1, 1, 1])
    (norm3): MinkowskiBatchNorm(128, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
    (block3): BasicBlockBN(
      (conv1): MinkowskiConvolution(in=128, out=128, region_type=RegionType.HYPERCUBE, kernel_size=[3, 3, 3], stride=[1, 1, 1], dilation=[1, 1, 1])
      (norm1): MinkowskiBatchNorm(128, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
      (conv2): MinkowskiConvolution(in=128, out=128, region_type=RegionType.HYPERCUBE, kernel_size=[3, 3, 3], stride=[1, 1, 1], dilation=[1, 1, 1])
      (norm2): MinkowskiBatchNorm(128, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
    )
    (conv4): MinkowskiConvolution(in=128, out=256, region_type=RegionType.HYPERCUBE, kernel_size=[3, 3, 3], stride=[2, 2, 2], dilation=[1, 1, 1])
    (norm4): MinkowskiBatchNorm(256, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
    (block4): BasicBlockBN(
      (conv1): MinkowskiConvolution(in=256, out=256, region_type=RegionType.HYPERCUBE, kernel_size=[3, 3, 3], stride=[1, 1, 1], dilation=[1, 1, 1])
      (norm1): MinkowskiBatchNorm(256, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
      (conv2): MinkowskiConvolution(in=256, out=256, region_type=RegionType.HYPERCUBE, kernel_size=[3, 3, 3], stride=[1, 1, 1], dilation=[1, 1, 1])
      (norm2): MinkowskiBatchNorm(256, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
    )
    (conv4_tr): MinkowskiConvolutionTranspose(in=256, out=128, region_type=RegionType.HYPERCUBE, kernel_size=[3, 3, 3], stride=[2, 2, 2], dilation=[1, 1, 1])
    (norm4_tr): MinkowskiBatchNorm(128, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
    (block4_tr): BasicBlockBN(
      (conv1): MinkowskiConvolution(in=128, out=128, region_type=RegionType.HYPERCUBE, kernel_size=[3, 3, 3], stride=[1, 1, 1], dilation=[1, 1, 1])
      (norm1): MinkowskiBatchNorm(128, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
      (conv2): MinkowskiConvolution(in=128, out=128, region_type=RegionType.HYPERCUBE, kernel_size=[3, 3, 3], stride=[1, 1, 1], dilation=[1, 1, 1])
      (norm2): MinkowskiBatchNorm(128, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
    )
    (conv3_tr): MinkowskiConvolutionTranspose(in=256, out=64, region_type=RegionType.HYPERCUBE, kernel_size=[3, 3, 3], stride=[2, 2, 2], dilation=[1, 1, 1])
    (norm3_tr): MinkowskiBatchNorm(64, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
    (block3_tr): BasicBlockBN(
      (conv1): MinkowskiConvolution(in=64, out=64, region_type=RegionType.HYPERCUBE, kernel_size=[3, 3, 3], stride=[1, 1, 1], dilation=[1, 1, 1])
      (norm1): MinkowskiBatchNorm(64, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
      (conv2): MinkowskiConvolution(in=64, out=64, region_type=RegionType.HYPERCUBE, kernel_size=[3, 3, 3], stride=[1, 1, 1], dilation=[1, 1, 1])
      (norm2): MinkowskiBatchNorm(64, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
    )
    (conv2_tr): MinkowskiConvolutionTranspose(in=128, out=64, region_type=RegionType.HYPERCUBE, kernel_size=[3, 3, 3], stride=[2, 2, 2], dilation=[1, 1, 1])
    (norm2_tr): MinkowskiBatchNorm(64, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
    (block2_tr): BasicBlockBN(
      (conv1): MinkowskiConvolution(in=64, out=64, region_type=RegionType.HYPERCUBE, kernel_size=[3, 3, 3], stride=[1, 1, 1], dilation=[1, 1, 1])
      (norm1): MinkowskiBatchNorm(64, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
      (conv2): MinkowskiConvolution(in=64, out=64, region_type=RegionType.HYPERCUBE, kernel_size=[3, 3, 3], stride=[1, 1, 1], dilation=[1, 1, 1])
      (norm2): MinkowskiBatchNorm(64, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
    )
    (conv1_tr): MinkowskiConvolution(in=96, out=64, region_type=RegionType.HYPERCUBE, kernel_size=[1, 1, 1], stride=[1, 1, 1], dilation=[1, 1, 1])
    (final): MinkowskiConvolution(in=64, out=32, region_type=RegionType.HYPERCUBE, kernel_size=[1, 1, 1], stride=[1, 1, 1], dilation=[1, 1, 1])
  )
  (feature_extraction1): ResUNetBN2C(
    (conv1): MinkowskiConvolution(in=1, out=32, region_type=RegionType.HYPERCUBE, kernel_size=[5, 5, 5], stride=[1, 1, 1], dilation=[1, 1, 1])
    (norm1): MinkowskiBatchNorm(32, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
    (block1): BasicBlockBN(
      (conv1): MinkowskiConvolution(in=32, out=32, region_type=RegionType.HYPERCUBE, kernel_size=[3, 3, 3], stride=[1, 1, 1], dilation=[1, 1, 1])
      (norm1): MinkowskiBatchNorm(32, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
      (conv2): MinkowskiConvolution(in=32, out=32, region_type=RegionType.HYPERCUBE, kernel_size=[3, 3, 3], stride=[1, 1, 1], dilation=[1, 1, 1])
      (norm2): MinkowskiBatchNorm(32, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
    )
    (conv2): MinkowskiConvolution(in=32, out=64, region_type=RegionType.HYPERCUBE, kernel_size=[3, 3, 3], stride=[2, 2, 2], dilation=[1, 1, 1])
    (norm2): MinkowskiBatchNorm(64, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
    (block2): BasicBlockBN(
      (conv1): MinkowskiConvolution(in=64, out=64, region_type=RegionType.HYPERCUBE, kernel_size=[3, 3, 3], stride=[1, 1, 1], dilation=[1, 1, 1])
      (norm1): MinkowskiBatchNorm(64, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
      (conv2): MinkowskiConvolution(in=64, out=64, region_type=RegionType.HYPERCUBE, kernel_size=[3, 3, 3], stride=[1, 1, 1], dilation=[1, 1, 1])
      (norm2): MinkowskiBatchNorm(64, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
    )
    (conv3): MinkowskiConvolution(in=64, out=128, region_type=RegionType.HYPERCUBE, kernel_size=[3, 3, 3], stride=[2, 2, 2], dilation=[1, 1, 1])
    (norm3): MinkowskiBatchNorm(128, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
    (block3): BasicBlockBN(
      (conv1): MinkowskiConvolution(in=128, out=128, region_type=RegionType.HYPERCUBE, kernel_size=[3, 3, 3], stride=[1, 1, 1], dilation=[1, 1, 1])
      (norm1): MinkowskiBatchNorm(128, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
      (conv2): MinkowskiConvolution(in=128, out=128, region_type=RegionType.HYPERCUBE, kernel_size=[3, 3, 3], stride=[1, 1, 1], dilation=[1, 1, 1])
      (norm2): MinkowskiBatchNorm(128, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
    )
    (conv4): MinkowskiConvolution(in=128, out=256, region_type=RegionType.HYPERCUBE, kernel_size=[3, 3, 3], stride=[2, 2, 2], dilation=[1, 1, 1])
    (norm4): MinkowskiBatchNorm(256, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
    (block4): BasicBlockBN(
      (conv1): MinkowskiConvolution(in=256, out=256, region_type=RegionType.HYPERCUBE, kernel_size=[3, 3, 3], stride=[1, 1, 1], dilation=[1, 1, 1])
      (norm1): MinkowskiBatchNorm(256, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
      (conv2): MinkowskiConvolution(in=256, out=256, region_type=RegionType.HYPERCUBE, kernel_size=[3, 3, 3], stride=[1, 1, 1], dilation=[1, 1, 1])
      (norm2): MinkowskiBatchNorm(256, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
    )
    (conv4_tr): MinkowskiConvolutionTranspose(in=256, out=128, region_type=RegionType.HYPERCUBE, kernel_size=[3, 3, 3], stride=[2, 2, 2], dilation=[1, 1, 1])
    (norm4_tr): MinkowskiBatchNorm(128, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
    (block4_tr): BasicBlockBN(
      (conv1): MinkowskiConvolution(in=128, out=128, region_type=RegionType.HYPERCUBE, kernel_size=[3, 3, 3], stride=[1, 1, 1], dilation=[1, 1, 1])
      (norm1): MinkowskiBatchNorm(128, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
      (conv2): MinkowskiConvolution(in=128, out=128, region_type=RegionType.HYPERCUBE, kernel_size=[3, 3, 3], stride=[1, 1, 1], dilation=[1, 1, 1])
      (norm2): MinkowskiBatchNorm(128, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
    )
    (conv3_tr): MinkowskiConvolutionTranspose(in=256, out=64, region_type=RegionType.HYPERCUBE, kernel_size=[3, 3, 3], stride=[2, 2, 2], dilation=[1, 1, 1])
    (norm3_tr): MinkowskiBatchNorm(64, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
    (block3_tr): BasicBlockBN(
      (conv1): MinkowskiConvolution(in=64, out=64, region_type=RegionType.HYPERCUBE, kernel_size=[3, 3, 3], stride=[1, 1, 1], dilation=[1, 1, 1])
      (norm1): MinkowskiBatchNorm(64, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
      (conv2): MinkowskiConvolution(in=64, out=64, region_type=RegionType.HYPERCUBE, kernel_size=[3, 3, 3], stride=[1, 1, 1], dilation=[1, 1, 1])
      (norm2): MinkowskiBatchNorm(64, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
    )
    (conv2_tr): MinkowskiConvolutionTranspose(in=128, out=64, region_type=RegionType.HYPERCUBE, kernel_size=[3, 3, 3], stride=[2, 2, 2], dilation=[1, 1, 1])
    (norm2_tr): MinkowskiBatchNorm(64, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
    (block2_tr): BasicBlockBN(
      (conv1): MinkowskiConvolution(in=64, out=64, region_type=RegionType.HYPERCUBE, kernel_size=[3, 3, 3], stride=[1, 1, 1], dilation=[1, 1, 1])
      (norm1): MinkowskiBatchNorm(64, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
      (conv2): MinkowskiConvolution(in=64, out=64, region_type=RegionType.HYPERCUBE, kernel_size=[3, 3, 3], stride=[1, 1, 1], dilation=[1, 1, 1])
      (norm2): MinkowskiBatchNorm(64, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
    )
    (conv1_tr): MinkowskiConvolution(in=96, out=64, region_type=RegionType.HYPERCUBE, kernel_size=[1, 1, 1], stride=[1, 1, 1], dilation=[1, 1, 1])
    (final): MinkowskiConvolution(in=64, out=32, region_type=RegionType.HYPERCUBE, kernel_size=[1, 1, 1], stride=[1, 1, 1], dilation=[1, 1, 1])
  )
  (detection0): Detection()
  (detection1): Detection()
)
{'out_dir': './outputs/ThreeDMatchPairDataset-v0.05/JointLossTrainer/JointNet/modelnout32', 'trainer': 'JointLossTrainer', 'save_freq_epoch': 1, 'batch_size': 8, 'val_batch_size': 1, 'use_hard_negative': True, 'hard_negative_sample_ratio': 0.05, 'hard_negative_max_num': 3000, 'num_pos_per_batch': 1024, 'num_hn_samples_per_batch': 256, 'neg_thresh': 1.4, 'pos_thresh': 0.1, 'neg_weight': 1, 'use_random_scale': True, 'min_scale': 0.8, 'max_scale': 1.2, 'use_random_rotation': True, 'rotation_range': 360, 'train_phase': 'train', 'val_phase': 'val', 'test_phase': 'test', 'stat_freq': 40, 'test_valid': True, 'val_max_iter': 400, 'val_epoch_freq': 1, 'positive_pair_search_voxel_size_multiplier': 1.5, 'hit_ratio_thresh': 0.3, 'triplet_num_pos': 256, 'triplet_num_hn': 512, 'triplet_num_rand': 1024, 'model': 'JointNet', 'backbone_model': 'ResUNetBN2C', 'model_n_out': 32, 'conv1_kernel_size': 5, 'normalize_feature': True, 'dist_type': 'L2', 'best_val_metric': 'feat_match_ratio', 'optimizer': 'SGD', 'max_epoch': 200, 'lr': 0.1, 'momentum': 0.8, 'sgd_momentum': 0.9, 'sgd_dampening': 0.1, 'adam_beta1': 0.9, 'adam_beta2': 0.999, 'weight_decay': 0.0001, 'iter_size': 1, 'bn_momentum': 0.05, 'exp_gamma': 0.99, 'scheduler': 'ExpLR', 'icp_cache_path': '/disk/kitti/', 'use_gpu': True, 'weights': None, 'weights_dir': None, 'resume': None, 'resume_dir': None, 'train_num_thread': 2, 'val_num_thread': 1, 'test_num_thread': 2, 'fast_validation': False, 'nn_max_n': 500, 'dataset': 'ThreeDMatchPairDataset', 'voxel_size': 0.05, 'threed_match_dir': '/cluster/scratch/majing/threedmatch/', 'kitti_root': '/disk/kitti/', 'kaist_root': '/disk_ssd/kaist/', 'kitti_max_time_diff': 3, 'kaist_max_time_diff': 3, 'kitti_date': '2011_09_26', 'kaist_date': '2020_03_10'}
04/06 19:56:23 Resetting the data loader seed to 0
[[6676, 8435]]
04/06 19:56:24 Feature Extraction Done
[0 0] [6676 8435]
torch.Size([6676, 3]) torch.Size([8435, 3]) torch.Size([6676, 32]) torch.Size([8435, 32])
04/06 19:56:24 Coord_seperation Done
04/06 19:56:24 Beta Done
Traceback (most recent call last):
  File "train.py", line 86, in <module>
    main(config)
  File "train.py", line 65, in main
    trainer.train()
  File "/cluster/scratch/majing/FCGF/lib/trainer.py", line 144, in train
    val_dict = self._valid_epoch()
  File "/cluster/scratch/majing/FCGF/lib/trainer.py", line 931, in _valid_epoch
    out = self.model(sinput0,sinput1,len_batch)
  File "/cluster/home/majing/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 532, in __call__
    result = self.forward(*input, **kwargs)
  File "/cluster/scratch/majing/FCGF/model/resunet.py", line 383, in forward
    score0 = self.detection0(batch_C0,batch_F0,len(len_batch))
  File "/cluster/home/majing/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 532, in __call__
    result = self.forward(*input, **kwargs)
  File "/cluster/scratch/majing/FCGF/model/resunet.py", line 268, in forward
    device=device)),0
  File "/cluster/scratch/majing/FCGF/model/resunet.py", line 287, in _detection_score
    every_dist = (((coords_confusion[:, :, 0, :] - coords_confusion[:, :, 1, :]) ** 2).sum(dim=2) ** 0.5).float16()
AttributeError: 'Tensor' object has no attribute 'float16'
